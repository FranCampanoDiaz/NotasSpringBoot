<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>NoteApp</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Inter"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
</head>
<body class="bg-background-light dark:bg-background-dark font-display">
<div class="relative flex h-auto min-h-screen w-full flex-col">
    <div class="flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-primary/20 dark:border-primary/30 px-6 md:px-10 py-4">
            <div class="flex items-center gap-3 text-slate-900 dark:text-white">
                <div class="text-primary size-8">
                    <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 2H8C4.691 2 2 4.691 2 8v13h2V8c0-2.556 1.913-4.665 4.394-4.943A4.992 4.992 0 0 1 8 3h8c2.206 0 4 1.794 4 4v12c0 1.103-.897 2-2 2H8v-2h8c-1.103 0-2-.897-2-2V7c0-1.103-.897-2-2-2H8c-.566 0-1.093.242-1.465.649A5.023 5.023 0 0 1 5.95 6.05C6.016 6.033 6.082 6.018 6.149 6H8v15H6V8c0-1.103-.897-2-2-2s-2 .897-2 2v13a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8c0-3.309-2.691-6-6-6z"></path>
                    </svg>
                </div>
                <h1 class="text-xl font-bold">NoteApp</h1>
            </div>
            <div class="flex items-center gap-4">
                <button class="p-2 rounded-full hover:bg-primary/10 dark:hover:bg-primary/20 text-slate-600 dark:text-slate-300">
                    <span class="material-symbols-outlined">search</span>
                </button>
            </div>
        </header>
        <main class="flex-1 w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <h2 class="text-3xl font-bold text-slate-900 dark:text-white mb-6">My Notes</h2>
            <div id="notes-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

            </div>
        </main>
    </div>
    <button class="fixed bottom-8 right-8 bg-primary text-white rounded-full h-14 w-14 flex items-center justify-center shadow-lg hover:bg-primary/90 transition-colors">
        <span class="material-symbols-outlined text-3xl">add</span>
    </button>
</div>


<script>
    async function fetchNotes() {
        try {
            const response = await fetch('/api/notas');
            const notes = await response.json();
            renderNotes(notes);
        } catch (error) {
            console.error('Error al cargar notas:', error);
        }
    }

    async function deleteNote(id, button) {
        if (!confirm("¿Estás seguro que quiere eliminar la nota?")) return;

        try {
            const response = await fetch(`/api/notas/${id}`, {
                method: 'DELETE'
            });

            if (response.ok) {
                const card = button.closest('div.bg-white');
                card.remove();
                alert("Nota eliminada");

            } else alert("Error al eliminar");


        } catch (error) {
            console.error(error);
        }

    }

    function renderNotes(notes) {
        const container = document.getElementById('notes-container');
        container.innerHTML = '';

        if (notes.length === 0) {
            container.innerHTML = '<p class="text-gray-500">No hay notas disponibles.</p>';
            return;
        }

        notes.forEach(note => {
            const card = document.createElement('div');
            card.className = `
          bg-white p-6 rounded-lg shadow-md border-l-4 hover:shadow-lg
          ${note.completed ? 'border-green-500 bg-green-50 hover:border-green-500' : 'border-yellow-500'}
        `;

            card.innerHTML = `
  <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-2">${note.title}</h3>
  <p class="text-gray-600 dark:text-gray-300 mb-4">${note.description}</p>
  <p class="text-sm mb-4">
    <span class="font-medium">Estado:</span>
    <span class="${note.completed ? 'text-green-700' : 'text-yellow-700'} font-semibold">
      ${note.completed ? 'Completada' : 'Pendiente'}
    </span>
  </p>

    <div class="flex justify-end gap-2 mt-auto pt-2">
      <button onclick="editNote()" title="Editar" class="bg-primary text-white text-xs px-2 py-1 rounded hover:bg-blue-600 transition-colors duration-200">
        <span class="material-symbols-outlined text-base leading-none">edit</span>
      </button>
      <button onclick="deleteNote(${note.id},this)" title="Eliminar" class="bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600 transition-colors duration-200">
        <span class="material-symbols-outlined text-base leading-none">delete</span>
      </button>
    </div>
  </div>
`;


            container.appendChild(card);
        });
    }

    fetchNotes();
</script>

</body>
</html>
